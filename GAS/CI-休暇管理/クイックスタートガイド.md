# CI-休暇管理ボット クイックスタートガイド

## 🚀 5分で始める

このガイドでは、CI-休暇管理ボットを最短時間でセットアップする手順を説明します。

## 前提条件

- Googleアカウント（Gmail、Google Calendar、Google Apps Scriptにアクセス可能）
- 監視対象のGoogle Calendar（共有設定済み）
- 管理者権限

## セットアップ手順

### Step 1: Google Apps Scriptプロジェクトの作成

1. [Google Apps Script](https://script.google.com/) にアクセス
2. 「新しいプロジェクト」をクリック
3. プロジェクト名を「CI-休暇管理」に変更
4. デフォルトの `Code.gs` ファイルを削除

### Step 2: スクリプトの配置

1. `calendar-notification.js` の内容をコピー
2. 新しいファイルを作成し、名前を「calendar-notification」に設定
3. コピーしたコードを貼り付け
4. 保存（Ctrl+S）

### Step 3: 設定値の変更

`CONFIG` オブジェクト内の以下の値を変更：

```javascript
const CONFIG = {
  CALENDAR: {
    ID: 'your-calendar-id@group.calendar.google.com',  // ← ここを変更
    // 他の設定はそのまま
  },
  NOTIFICATION: {
    HR_EMAIL: 'hr@yourcompany.com',      // ← ここを変更
    ADMIN_EMAIL: 'admin@yourcompany.com', // ← ここを変更
    EMAIL_OPTIONS: {
      from: 'attendance@yourcompany.com',           // ← ここを変更
      name: 'CI-休暇管理通知'
    }
  }
};
```

### Step 4: 初回実行と権限設定

1. スクリプトエディタで `testAttendanceReport` 関数を選択
2. 「実行」ボタンをクリック
3. 権限の承認を求められたら「許可」をクリック
4. 実行ログでエラーがないことを確認

### Step 5: トリガーの設定

1. スクリプトエディタで `setupTrigger` 関数を選択
2. 「実行」ボタンをクリック
3. 「トリガー」メニューで設定が反映されていることを確認

## 動作確認

### テスト用カレンダーイベントの作成

1. 監視対象カレンダーにテストイベントを作成：
   - **タイトル**: `テスト太郎 - 全休`
   - **日付**: 今日または明日
   - **説明**: `申請者: テスト太郎`

2. 手動テスト実行：
   ```javascript
   testAttendanceReport();
   ```

3. メールが送信されることを確認

## よくある問題と解決法

### ❌ カレンダーが見つからないエラー
**解決法**:
1. カレンダーIDを確認
2. カレンダーの共有設定で「閲覧者」権限を付与

### ❌ メール送信エラー
**解決法**:
1. 送信者アドレスが有効か確認
2. Gmail送信権限を再設定

### ❌ イベントが検知されない
**解決法**:
1. イベントタイトルが「[名前] - [種別]」形式か確認
2. 対象種別に含まれているか確認

## 運用開始後の確認事項

### 毎日の確認
- [ ] 9:00と17:00に自動実行されているか
- [ ] エラーメールが来ていないか
- [ ] 通知メールが正しく送信されているか

### 週次の確認
- [ ] 実行ログにエラーがないか
- [ ] トリガーが正常に動作しているか
- [ ] 設定値に変更が必要ないか

## トラブルシューティング

### 緊急時の対応

#### 1. システムが停止した場合
```javascript
// データをクリアして再実行
clearStoredData();
testAttendanceReport();
```

#### 2. 重複通知が発生した場合
```javascript
// データをクリア
clearStoredData();
```

#### 3. 設定を変更した場合
```javascript
// 設定確認
checkConfiguration();
```

### ログの確認方法

1. スクリプトエディタで「実行」→「実行ログ」を選択
2. エラーメッセージを確認
3. 必要に応じて詳細ログを追加

## サポート

問題が解決しない場合は、以下までご連絡ください：

- **開発者**: システム管理者
- **連絡先**: admin@yourcompany.com
- **緊急時**: システム管理者に直接連絡

## 次のステップ

システムが正常に動作することを確認したら、以下を検討してください：

1. **詳細設定の調整**: 通知時間、対象種別の変更
2. **監視体制の構築**: エラー通知の設定
3. **運用ルールの策定**: メンテナンス計画の作成

---

**🎉 おめでとうございます！CI-休暇管理ボットのセットアップが完了しました。**

*このガイドで問題が解決しない場合は、詳細な仕様書をご参照ください。* 